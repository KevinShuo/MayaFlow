# -*- coding: utf-8 -*-
import os
from enum import Enum

from .base import MayaBasePy2


class SaveType(Enum):
    ma = "mayaAscii"
    mb = "mayaBinary"


class MayaFileOperatorPy2:
    def __init__(self):
        self._maya_base = MayaBasePy2()

    def new(self, force=False):
        # type: (bool) -> MayaFileOperatorPy2
        self.cmds.file(new=True, f=force)
        return self

    def open(self, url, force=False):
        # type: (str,bool) -> MayaFileOperatorPy2
        self.cmds.file(url, o=True, f=force)
        return self

    def save(self, save_type, force=False):
        # type: (SaveType,bool) -> MayaFileOperatorPy2
        self.cmds.file(save=True, type=save_type.value, force=force)
        return self

    def save_as(self, url, save_type, force=False):
        # type: (str,SaveType,bool) -> MayaFileOperatorPy2
        dir_path = os.path.dirname(url)
        if not os.path.exists(dir_path):
            raise FileNotFoundError("Directory '{}' does not exist".format(dir_path))
        self.cmds.file(rename=url.replace("\\", "/"))
        self.save(save_type.value, force=force)

    @property
    def cmds(self):
        return self._maya_base.cmds()
